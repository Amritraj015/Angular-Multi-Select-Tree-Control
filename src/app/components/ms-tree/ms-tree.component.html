<div class="inner-tree-container">
  <form>
    <input
      class="form-control mt-1 mb-2 w-100"
      type="text"
      autofocus="autofocus"
      aria-label="Number"
      placeholder="Search"
      matInput
      [formControl]="searchControl"
      [matAutocomplete]="auto"
      (input)="searchTerm = $event.target.value"
    />
    <mat-autocomplete #auto="matAutocomplete">
      <mat-option
        *ngFor="let option of (filteredOptions | async)"
        [value]="option"
      >
        {{ option }}
      </mat-option>
    </mat-autocomplete>
  </form>

  <mat-tab-group>
    <mat-tab label="Show All"></mat-tab>
    <mat-tab label="Show Selected"></mat-tab>
  </mat-tab-group>

  <div class="tree-display">
    <mat-tree
      [dataSource]="dataSource"
      [treeControl]="treeControl"
      class="ms-tree"
    >
      <!-- This is the tree node template for leaf nodes -->
      <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
        <li class="mat-tree-node">
          <!-- use of a disabled button to provide padding for tree leaf -->
          <button mat-icon-button disabled></button>

          <mat-checkbox
            [checked]="node.nodeSelected"
            (change)="isNodeSelected(node)"
            color="warn"
            ><div [innerHTML]="node.nodeName | searchFilter: searchTerm"></div
          ></mat-checkbox>
        </li>
      </mat-tree-node>

      <!-- This is the tree node template for expandable nodes -->
      <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
        <li>
          <div class="mat-tree-node">
            <button
              mat-icon-button
              matTreeNodeToggle
              [attr.aria-label]="'toggle ' + node.nodeName"
            >
              <mat-icon class="mat-icon-rtl-mirror">
                {{
                  treeControl.isExpanded(node) ? "expand_more" : "chevron_right"
                }}
              </mat-icon>
            </button>

            <mat-checkbox
              [checked]="node.nodeSelected"
              (change)="isNodeSelected(node)"
              color="warn"
              ><div [innerHTML]="node.nodeName | searchFilter: searchTerm"></div
            ></mat-checkbox>
          </div>

          <ul [class.ms-tree-invisible]="!treeControl.isExpanded(node)">
            <ng-container matTreeNodeOutlet></ng-container>
          </ul>
        </li>
      </mat-nested-tree-node>
    </mat-tree>
  </div>
</div>
